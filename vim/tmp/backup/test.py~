#!/usr/bin/env python2
import re
import urllib2
from mom.codec import base85


def conv(x):
    try:
        x = chr(int(x, 16))
    except:
        pass
    return x


def sk1():
    s = open('packet.txt').readlines()
    s = map(lambda x: x[57:], s)
    s = ''.join(s)
    s = re.sub('[\s\n]', '', s)
    s = s.split('%')[1:]
    s = map(conv, s)
    print ''.join(s)


def sk2():
    data = urllib2.urlopen('http://kaimi.ru/quest_x4/data/search.txt').read()
    pattern = '[^A-Za-z0-9\s\n\t]\t[a-z]{2}[A-Z]{2}.[a-zA-Z]{3}[0-9][0-9].......'
    d = re.findall(pattern, data)
    print re.sub('[^A-Za-z0-9]', '', d[0])


def sk3():
    data = urllib2.urlopen('http://kaimi.ru/quest_x4/data/numbers.txt').read().split()
    print len(data)
    data = filter(is_luhn_valid, data)
    print data


def luhn_checksum(card_number):
    def digits_of(n):
        return [int(d) for d in str(n)]
    digits = digits_of(card_number)
    odd_digits = digits[-1::-2]
    even_digits = digits[-2::-2]
    checksum = 0
    checksum += sum(odd_digits)
    for d in even_digits:
        checksum += sum(digits_of(d * 2))
    return checksum % 10


def is_luhn_valid(card_number):
    return luhn_checksum(card_number) == 0


def sk4():
    s = '<~FCfN8F(K62ASu!h~>'
    print base85.b85decode(s)


def main():
    sk4()

if __name__ == '__main__':
    main()
